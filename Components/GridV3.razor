@* GridV3 - Enhanced CSS Grid with blue dot droppables and collected state *@
@using p07_vimkeys_game.Domain.Entities
@using p07_vimkeys_game.Domain.ValueObjects

<style>
  /* Dynamic styles that depend on Game.GridSize */
  #grid {
    grid-template-columns: repeat(@Game.GridSize, 60px);
    grid-template-rows: repeat(@Game.GridSize, 60px);
  }
</style>

<div id="grid">
  @for (int y = 0; y < Game.GridSize; y++)
  {
    @for (int x = 0; x < Game.GridSize; x++)
    {
      var currentPos = new Position(x, y);
      var isPlayer = Game.Player.Position == currentPos;
      var hasDroppable = Game.Droppables.Any(d => !d.IsCollected && d.Position == currentPos);
      var wasCollected = Game.Droppables.Any(d => d.IsCollected && d.Position == currentPos);

      var classes = "cell";
      if (isPlayer) classes += " player";
      if (hasDroppable) classes += " droppable";
      if (wasCollected) classes += " collected";

      <div class="@classes" data-row="@y" data-col="@x"></div>
    }
  }
</div>

@code {
    [Parameter] public Game Game { get; set; } = null!;
}
