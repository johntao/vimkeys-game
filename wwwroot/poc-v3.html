<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Vim Keys Grid Game - V3 (Table with Player Marker)</title>
    <style>
      table {
        border-collapse: collapse;
      }
      td {
        width: 60px;
        height: 60px;
        border: 1px solid black;
        text-align: center;
        vertical-align: middle;
      }
      .player-cell::before {
        content: 'â–¶ ';
        color: red;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <table id="grid"></table>

    <script src="lib/grid-state.js"></script>
    <script src="lib/vim-navigation.js"></script>
    <script>
      // Initialize grid state
      const gridState = new GridState(5);
      const grid = document.getElementById('grid');
      const cells = [];

      // Create 5x5 grid using table
      for (let row = 0; row < gridState.size; row++) {
        const tr = document.createElement('tr');
        const rowCells = [];

        for (let col = 0; col < gridState.size; col++) {
          const td = document.createElement('td');
          td.textContent = `${row}${col}`;
          td.dataset.row = row;
          td.dataset.col = col;
          tr.appendChild(td);
          rowCells.push(td);
        }

        grid.appendChild(tr);
        cells.push(rowCells);
      }

      // Mark initial player position
      const initialPos = gridState.getPosition();
      cells[initialPos.row][initialPos.col].classList.add('player-cell');

      // Setup vim navigation
      const navigation = new VimNavigation(gridState, (position, direction) => {
        // Get old position before move
        const oldPos = {
          row: position.row + (direction === 'up' ? 1 : direction === 'down' ? -1 : 0),
          col: position.col + (direction === 'left' ? 1 : direction === 'right' ? -1 : 0)
        };

        // Remove player marker from old position
        cells[oldPos.row][oldPos.col].classList.remove('player-cell');

        // Add player marker to new position
        cells[position.row][position.col].classList.add('player-cell');
      });
      navigation.enable();
    </script>
  </body>
</html>
